"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{2195:function(a,b,c){c.d(b,{Z:function(){return i}});var d=c(5893),e=c(7294),f=c(3587),g=c(3629),h=c(3664);function i(a){var b=a.isOpen,c=a.onClose,i=a.message,j=a.title,k=a.hideSecondaryBtn,l=a.primaryBtnLabel;return(0,d.jsx)(f.u,{appear:!0,show:b,as:e.Fragment,children:(0,d.jsxs)(g.V,{as:"div",className:"relative z-10",onClose:c,children:[(0,d.jsx)(f.u.Child,{as:e.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,d.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,d.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,d.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,d.jsx)(f.u.Child,{as:e.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,d.jsxs)(g.V.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,d.jsx)(g.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:j}),(0,d.jsx)("div",{className:"mt-2",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:i})}),(0,d.jsxs)("div",{className:"mt-4 flex justify-start",children:[(0,d.jsx)(h.Z,{secondary:!0,className:"mr-10",onClick:function(){return c(!0)},children:(void 0===l?"":l)||"Yes"}),!k&&(0,d.jsx)(h.Z,{primary:!0,onClick:function(){return c(!1)},children:"No"})]})]})})})})]})})}},641:function(a,b,c){c.d(b,{Z:function(){return B}});var d=c(4924),e=c(6042),f=c(9396),g=c(5893),h=c(7294),i=c(2664),j=c(1163),k=c(3157),l=c(9198),m=c.n(l),n=c(1296),o=c.n(n),p=c(2814),q=c(1436),r=c(2920),s=c(9819),t=c(3664),u=c(1833),v=c(4364),w=c(3096),x=c(4750),y=c(2195),z=(0,h.forwardRef)(function(a,b){var c=a.value,d=a.onClick;return(0,g.jsx)(s.Z,{type:"text",name:"date",onClick:d,ref:b,value:c,autoComplete:"off",className:"customer-ctrl"})});function A(a){var b,c=a.addPurchase,i=a.editPurchase,l=a.searchProducts,n=a.fetchPurchaseOrder,w=a.removePurchase,x=(0,j.useRouter)(),A=x.params?null===(b=x.params)|| void 0===b?void 0:b.id:void 0,B=!!A,C=(0,h.useState)(new Date),D=C[0],E=C[1],F=(0,h.useState)({}),G=F[0],H=F[1],I=(0,h.useState)(0),J=I[0],K=I[1],L=(0,h.useState)(0),M=L[0],N=L[1],O=(0,h.useState)(0),P=O[0],Q=O[1],R=(0,h.useState)([]),S=R[0],T=R[1],U=(0,h.useState)([]),V=U[0],W=U[1],X=(0,h.useState)(),Y=X[0],Z=X[1],$=(0,h.useState)(""),_=$[0],aa=$[1],ab=(0,h.useRef)([]),ac=(0,h.useState)(!1),ad=ac[0],ae=ac[1],af=function(a){l({searchText:a,isCallback:!0,callback:function(a){if(Array.isArray(a)){var b=[];a.forEach(function(a){ab.current.find(function(b){return b.id===a.id})||b.push((0,f.Z)((0,e.Z)({},a),{label:a.name,value:a.id}))}),W(b)}}})},ag=function(a){ab.current=a},ah=o()(af,1e3);(0,h.useEffect)(function(){A&&n({id:A,callback:function(a){E(new Date(a.date)),aa(a.supplier),N(a.total_discount),Q(a.tax),K(a.package_charges);var b=a.order_details.map(function(a){return{name:a.product.name,id:a.product.id,quantity:a.quantity,rate:a.rate,discount:a.discount}});T(b),ag(b)}})},[A]),(0,h.useEffect)(function(){af("")},[]);var ai=(0,h.useMemo)(function(){var a=0,b=0,c=0,d=0,e=0;return S.forEach(function(a){var c=a.quantity?a.quantity:0,d=a.rate?a.rate:0,e=a.discount?a.discount:0,f=c*d;if(e){var g=f*e/100;f-=g}b+=f}),d=b,M&&M>0&&(c=b*M/100,b-=c),a=J&&J>0?b+J:b,P&&P>0&&(a+=e=b*P/100),{billTotal:(0,v.Y4)(a),subTotal:(0,v.Y4)(b),discountAmt:(0,v.Y4)(c),totalGoodsValue:(0,v.Y4)(d),taxAmt:(0,v.Y4)(e)}},[S,M,J,P]),aj=ai.billTotal,ak=ai.subTotal,al=ai.discountAmt,am=ai.totalGoodsValue;ai.taxAmt;var an=function(a){var b=a.target,c=b.value,g=b.name;switch(g){case"packageing":K(parseInt(c,10));break;case"discount":N(parseInt(c,10));break;case"tax":Q(parseInt(c,10));break;case"supplier":aa(c)}H(function(a){return(0,f.Z)((0,e.Z)({},a),(0,d.Z)({},g,!c))})},ao=function(a){E(a),H(function(b){return(0,f.Z)((0,e.Z)({},b),{date:!a})})},ap=function(){Y&&(T(function(a){var b=JSON.parse(JSON.stringify(a));return b.unshift((0,e.Z)({},Y)),ag(b),b}),W(function(a){var b=[];return a.forEach(function(a){a.id!==Y.id&&b.push((0,e.Z)({},a))}),b}),Z(null))},aq=function(a){T(function(b){var c=JSON.parse(JSON.stringify(b));return c.splice(a,1),ag(c),c})},ar=function(a,b,c){T(function(d){var e=JSON.parse(JSON.stringify(d));return e[a][b]=c,ag(e),e})},as=function(a,b,c){var d=a?parseInt(a,10):0,e=b?parseInt(b,10):0,f=c?parseInt(c,10):0,g=d*e,h=g*f/100;return Math.ceil(g-=h)},at=function(a,b,c){var d=a?parseInt(a,10):0,e=b?parseInt(b,10):0,f=c?parseInt(c,10):0;return Math.ceil(d*e*f/100)},au=function(){if(!D){H(function(a){return(0,f.Z)((0,e.Z)({},a),{date:!0})});return}if(!_){H(function(a){return(0,f.Z)((0,e.Z)({},a),{supplier:!0})});return}if(!P||P<0){r.Am.warn("Please enter GST (tax)");return}if(!Array.isArray(S)||S.length<=0){r.Am.success("Select atleast 1 product");return}var a=S.find(function(a){return!a.quantity||!!(a.quantity<=0)||!a.rate||!!(a.rate<=0)});if(a){r.Am.error("Check quantity or rate for ".concat(a.name));return}var b=S.map(function(a){return{quantity:parseInt(a.quantity,10),discount:a.discount?parseInt(a.discount,10):0,rate:parseInt(a.rate),orderStatus:!!a.orderStatus,id:a.id}}),d={supplier:_,date:(0,v.zb)(D),totalDiscount:M||0,packageCharges:J||0,tax:P,orderDetails:b};B?(d.id=parseInt(A,10),i({payload:d,callback:function(){r.Am.success("Successfully updated purchase order"),x.push(u.adminPurchaseList)}})):c({payload:d,callback:function(){r.Am.success("Successfully added purchase order"),x.push(u.adminPurchaseList)}})},av=function(){x.push(u.adminPurchaseList)},aw=function(a){S.find(function(b){return b.id===a.id})?H(function(a){return(0,f.Z)((0,e.Z)({},a),{selectedProduct:!0})}):(Z(a),H(function(a){return(0,f.Z)((0,e.Z)({},a),{selectedProduct:!1})}))},ax=function(){ae(!0)},ay=function(a){ae(!1),a&&w({id:A,callback:function(a){a.success?(r.Am.success("Successfully deleted purchase order"),x.push(u.adminPurchaseList)):r.Am.error(a.message)}})};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(y.Z,{isOpen:ad,onClose:function(a){return ay(a)},title:"Are you sure?",message:"Are you sure you want to delete this purchase order?"}),(0,g.jsxs)("div",{className:"p-6 h-full add-edit-bills",children:[(0,g.jsxs)("div",{className:"text-lg font-bold mb-3 text-center",children:[B?"Edit":"Add"," Purchase"]}),(0,g.jsxs)("div",{className:"rounded-md pt-5 px-5 add-edit-bills__shadow md:w-3/4 md:m-auto ml-0 w-full",children:[(0,g.jsxs)("div",{className:"flex flex-wrap",children:[(0,g.jsxs)("div",{className:"mb-2 form-ctrl mr-2",children:[(0,g.jsx)("label",{className:"font-medium mb-3 text-gray-600",children:"Bill date *"}),(0,g.jsx)(m(),{onChange:ao,selected:D,dateFormat:"dd/MM/yyyy",customInput:(0,g.jsx)(z,{})}),G.date&&(0,g.jsx)("p",{className:"text-red-600 mt-3",children:"Bill date is required"})]}),(0,g.jsxs)("div",{className:"mb-2 form-ctrl",children:[(0,g.jsx)("label",{className:"font-medium mb-3 text-gray-600",children:"Supplier *"}),(0,g.jsx)(s.Z,{type:"text",name:"supplier",id:"supplier",className:"w-full",onChange:an,value:_,placeholder:"Supplier"}),G.supplier&&(0,g.jsx)("p",{className:"text-red-600 mt-3",children:"Please enter supplier"})]})]}),(0,g.jsxs)("div",{className:"product-list",children:[(0,g.jsx)("div",{className:"list-title add-edit-bills__shadow text-lg font-bold flex justify-between items-center",children:(0,g.jsx)("span",{children:"Products"})}),(0,g.jsxs)("div",{className:"my-2 flex",children:[(0,g.jsx)("div",{className:"form-ctrl",children:(0,g.jsx)(k.ZP,{isClearable:!0,onInputChange:ah,onChange:aw,options:V,value:Y})}),(0,g.jsxs)(t.Z,{onClick:ap,className:"flex items-center justify-center ml-2 w-fit px-3",children:[(0,g.jsx)(p.G,{icon:q.r8p}),(0,g.jsx)("span",{className:"inline-block ml-3",children:"Add"})]})]}),(0,g.jsx)("div",{className:"my-2 flex",children:G.selectedProduct&&(0,g.jsx)("p",{className:"text-red-600 mt-3",children:"Product already added"})}),(0,g.jsx)("div",{className:"list-container",children:S.length>0?S.map(function(a,b){return(0,g.jsxs)("div",{className:"product-card border rounded-md relative",children:[(0,g.jsx)("div",{className:"text-2xl font-normal",children:a.name}),(0,g.jsxs)("div",{className:"flex",children:[(0,g.jsxs)("div",{className:"flex flex-col mr-3",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600",children:"Quantity"}),(0,g.jsx)(s.Z,{type:"number",name:"Quantity",className:"input-ctrl",value:a.quantity,onChange:function(a){return ar(b,"quantity",a.target.value)},placeholder:"Quantity",min:2})]}),(0,g.jsxs)("div",{className:"flex flex-col mr-3",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600",children:"Rate"}),(0,g.jsx)(s.Z,{type:"number",name:"Rate",className:"input-ctrl",onChange:function(a){return ar(b,"rate",a.target.value)},placeholder:"Rate",value:a.rate,min:20})]}),(0,g.jsx)("div",{className:"flex flex-col mr-3",children:(0,g.jsx)("div",{className:"mt-9",children:"="})}),(0,g.jsxs)("div",{className:"flex flex-col mr-3",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600",children:"Amount"}),(0,g.jsx)(s.Z,{type:"number",name:"Rate",disabled:!0,className:"input-ctrl",placeholder:"Amount",value:Math.ceil(a.rate*a.quantity),min:20})]}),(0,g.jsx)("div",{className:"flex flex-col mr-3",children:(0,g.jsx)("div",{className:"mt-9",children:"x"})}),(0,g.jsxs)("div",{className:"flex flex-col mr-1",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600",children:"Discount %"}),(0,g.jsx)(s.Z,{type:"number",name:"discount",className:"input-ctrl",onChange:function(a){return ar(b,"discount",a.target.value)},placeholder:"Discount",value:a.discount,min:0})]}),(0,g.jsx)("div",{className:"flex flex-col mr-3",children:(0,g.jsx)("div",{className:"mt-9",children:"%"})}),(0,g.jsx)("div",{className:"flex flex-col mr-3",children:(0,g.jsx)("div",{className:"mt-9",children:"="})}),(0,g.jsxs)("div",{className:"flex flex-col mr-1",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600",children:"Disc amount"}),(0,g.jsx)(s.Z,{type:"number",name:"discount",disabled:!0,className:"input-ctrl",placeholder:"Discount amount",value:at(a.rate,a.quantity,a.discount),min:0})]}),(0,g.jsx)("div",{className:"flex flex-col mr-3",children:(0,g.jsx)("div",{className:"mt-9",children:"="})}),(0,g.jsxs)("div",{className:"flex flex-col mr-3",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600",children:"Goods value"}),(0,g.jsx)(s.Z,{type:"number",name:"Goods value",disabled:!0,className:"input-ctrl",placeholder:"Goods value",value:as(a.rate,a.quantity,a.discount)})]})]}),(0,g.jsxs)("div",{className:"text-sm font-normal flex md:hidden mr-5",children:[(0,g.jsx)("label",{className:"mt-4 mr-3 text-gray-600",children:"Goods value:"}),(0,g.jsx)("span",{className:"inline-block mt-2 text-2xl",children:as(a.rate,a.quantity,a.discount)})]}),(0,g.jsx)("div",{onClick:function(){return aq(b)},className:"absolute top-1 right-2 cursor-pointer text-gray-600 text-2xl",title:"Remove item",children:(0,g.jsx)(p.G,{icon:q.g82})})]},a.id)}):(0,g.jsx)("div",{className:"text-lg font-medium my-16 mx-auto text-center",children:"No Products Selected"})}),(0,g.jsxs)("div",{className:"list-footer",children:[(0,g.jsxs)("div",{className:"flex flex-col justify-end items-end",children:[(0,g.jsxs)("div",{className:"mb-2",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600 mr-3",children:"Goods value"}),(0,g.jsx)(s.Z,{disabled:!0,value:am,type:"number",name:"Quantity",id:"quantity",className:"input-ctrl",placeholder:"Sub-total",min:2})]}),(0,g.jsxs)("div",{className:"mb-2 pb-2 border-b flex items-center",children:[(0,g.jsxs)("div",{className:"flex mr-3 items-center",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600 mr-3",children:"Discount %"}),(0,g.jsx)(s.Z,{type:"number",name:"discount",id:"discount",className:"input-ctrl",onChange:an,value:M,placeholder:"Discount",min:0})]}),(0,g.jsxs)("div",{className:"flex items-center",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600 mr-3",children:"Amount"}),(0,g.jsx)(s.Z,{disabled:!0,type:"number",name:"discount",id:"discount",className:"input-ctrl",value:al,placeholder:"Discount",min:0})]})]}),(0,g.jsxs)("div",{className:"mb-2",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600 mr-3",children:"Sub total"}),(0,g.jsx)(s.Z,{disabled:!0,value:ak,type:"number",name:"Quantity",id:"quantity",className:"input-ctrl",placeholder:"Sub-total",min:2})]}),(0,g.jsxs)("div",{className:"mb-2",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600 mr-3",children:"Packaging charges"}),(0,g.jsx)(s.Z,{type:"number",name:"packageing",id:"packageing",className:"input-ctrl",onChange:an,value:J,placeholder:"Packaging charges",min:0})]}),(0,g.jsxs)("div",{className:"mb-2",children:[(0,g.jsx)("label",{className:"mb-1 text-gray-600 mr-3",children:"Total"}),(0,g.jsx)(s.Z,{disabled:!0,value:aj,type:"number",name:"Quantity",id:"quantity",className:"input-ctrl",placeholder:"Total",min:2})]})]}),(0,g.jsxs)("div",{className:"flex ".concat(B?"justify-between":"justify-end"," mt-3"),children:[B&&(0,g.jsx)(p.G,{icon:q.$aW,className:"text-2xl cursor-pointer",onClick:ax}),(0,g.jsxs)("div",{className:"flex",children:[(0,g.jsxs)(t.Z,{onClick:au,className:"flex items-center justify-center ml-0 md:ml-5 w-fit px-3 mt-2 md:mt-0",children:[(0,g.jsx)(p.G,{icon:q.LEp}),(0,g.jsx)("span",{className:"inline-block ml-3",children:"Save"})]}),(0,g.jsxs)(t.Z,{onClick:av,secondary:!0,className:"flex items-center justify-center ml-0 md:ml-5 w-fit px-3 mt-2 md:mt-0",children:[(0,g.jsx)(p.G,{icon:q.g82}),(0,g.jsx)("span",{className:"inline-block ml-3",children:"Cancel"})]})]})]})]})]})]})]})]})}function B(){var a=(0,i.I0)();return(0,g.jsx)(A,{addPurchase:function(b){return a((0,x.QU)(b))},editPurchase:function(b){return a((0,x.CD)(b))},searchProducts:function(b){return a((0,w.ft)(b))},fetchPurchaseOrder:function(b){return a((0,x.eh)(b))},removePurchase:function(b){return a((0,x.uU)(b))}})}z.displayName="CustomInput"}}])